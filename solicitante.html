<!DOCTYPE html>
<html>
<head>
    <title>Solicitação de Carro</title>
    <script src="script.js"></script>
    <style>
        body {
            font-family: sans-serif;
            margin: 20px;
        }

        form {
            width: 400px;
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
        }

        input, select, textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            cursor: pointer;
        }

        #detalhesSolicitacao {
            margin-top: 20px;
            border: 1px solid #ccc;
            padding: 10px;
        }

        #solicitacaoForm {
            display: block;
        }

        #solicitacaoForm.solicitacaoEnviada {
            display: none;
        }

        #novaSolicitacaoButton {
            display: none;
        }
    </style>
</head>
<body>
    <h1>Solicitação de Carro</h1>
    <form id="solicitacaoForm">
        <!-- Campos do formulário -->
        <label for="matricula">Matrícula:</label><br>
        <input type="text" id="matricula" name="matricula"><br><br>

        <label for="solicitante">Solicitante:</label><br>
        <input type="text" id="solicitante" name="solicitante"><br><br>

        <label for="dataRetirada">Data Retirada:</label><br>
        <input type="date" id="dataRetirada" name="dataRetirada"><br><br>

        <label for="horaRetirada">Hora Retirada:</label><br>
        <input type="time" id="horaRetirada" name="horaRetirada"><br><br>

        <label for="dataDevolucao">Data Devolução:</label><br>
        <input type="date" id="dataDevolucao" name="dataDevolucao"><br><br>

        <label for="horaDevolucao">Hora Devolução:</label><br>
        <input type="time" id="horaDevolucao" name="horaDevolucao"><br><br>

        <label for="carro">Carro:</label><br>
        <select id="carro" name="carro">
            <option value="carro1">Carro 1</option>
            <option value="carro2">Carro 2</option>
            <option value="carro3">Carro 3</option>
        </select><br><br>

        <label for="motivo">Motivo:</label><br>
        <textarea id="motivo" name="motivo"></textarea><br><br>

        <label for="prioridade">Nível de Prioridade:</label><br>
        <select id="prioridade" name="prioridade">
          <option value="Baixa">Baixa</option>
          <option value="Media">Média</option>
          <option value="Alta">Alta</option>
        </select><br><br>

        <button type="button" onclick="enviarSolicitacao()">Enviar</button>
    </form>
    
    <div id="detalhesSolicitacao" style="display: none;">
        <h2>Detalhes da Solicitação</h2>
        <p><strong>Matrícula:</strong> <span id="detalhesMatricula"></span></p>
        <p><strong>Solicitante:</strong> <span id="detalhesSolicitante"></span></p>
        <p><strong>Status:</strong> <span id="detalhesStatus"></span></p>
    </div>

    <button id="novaSolicitacaoButton" onclick="mostrarFormulario()">Nova Solicitação</button>

    <script>
        // Salva a solicitação no localStorage para persistência
        function enviarSolicitacao() {
            const form = document.getElementById('solicitacaoForm');
            const formData = new FormData(form);
            const solicitacao = {};
            formData.forEach((value, key) => solicitacao[key] = value);

            // Simula o envio da solicitação
            let solicitacoes = JSON.parse(localStorage.getItem('solicitacoes') || '[]');
            solicitacao.status = 'pendente';

            // Verifica se o carro já está agendado
            const carroOcupado = solicitacoes.some(s => s.carro === solicitacao.carro &&
                s.dataRetirada === solicitacao.dataRetirada && s.horaRetirada === solicitacao.horaRetirada);
            if (carroOcupado) {
                alert('Este carro já está agendado para o horário solicitado!');
                return;
            }

            solicitacoes.push(solicitacao);
            localStorage.setItem('solicitacoes', JSON.stringify(solicitacoes));

            exibirDetalhesSolicitacao(solicitacao);

            // Esconde o formulário
            form.classList.add('solicitacaoEnviada');
            localStorage.setItem('matriculaSolicitacao', solicitacao.matricula);
            localStorage.setItem(`status_${solicitacao.matricula}`, 'pendente');
            document.getElementById('novaSolicitacaoButton').style.display = 'none'; // Esconde o botão de nova solicitação

            // Exibe o botão de nova solicitação
            setTimeout(function() {
                document.getElementById('novaSolicitacaoButton').style.display = 'block';
            }, 5000); // Mostra o botão após 5 segundos
        }

        // Exibe os detalhes da solicitação
        function exibirDetalhesSolicitacao(solicitacao) {
            document.getElementById('detalhesMatricula').textContent = solicitacao.matricula;
            document.getElementById('detalhesSolicitante').textContent = solicitacao.solicitante;
            document.getElementById('detalhesStatus').textContent = solicitacao.status;
            document.getElementById('detalhesSolicitacao').style.display = 'block';
        }

        function mostrarFormulario() {
            document.getElementById('solicitacaoForm').classList.remove('solicitacaoEnviada');
            document.getElementById('novaSolicitacaoButton').style.display = 'none';
        }

        // Carregar status da solicitação ao recarregar a página
        window.onload = function() {
            const matricula = localStorage.getItem('matriculaSolicitacao');
            const status = localStorage.getItem(`status_${matricula}`);

            if (status) {
                const solicitacao = {
                    matricula: matricula,
                    status: status
                };
                exibirDetalhesSolicitacao(solicitacao);
            }
        };
    </script>
</body>
</html>
